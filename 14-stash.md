
# `stash`
دستورات `stash` و `unstash` در Jenkins Pipeline برای آرشیو و بازیابی (Unstash) فایل‌ها به منظور انتقال آنها بین مراحل (stages) مختلف در یک Pipeline استفاده می‌شوند. این دستورات مفید هستند زمانی که نیاز به انتقال فایل‌ها (مثلاً فایل‌های سورس یا توابع تست) از یک مرحله به مرحله دیگر دارید.

در ادامه یک مثال از استفاده از `stash` و `unstash` در یک Jenkins Pipeline آورده شده است:

```groovy
pipeline {
    agent any
    options { 
        preserveStashes() 
    }
    stages {
        stage('Create') {
            steps {
                sh "echo 'hi' > test.txt" 
                stash includes: 'test.txt', name: 'myStash'
            }
        }

        stage('Read') {
            steps {
                unstash 'myStash'
                sh 'cat test.txt'
            }
        }
    }

    post {
        always {
            cleanWs()
        }
    }
}
```
![image](https://github.com/milad6745/jenkins/assets/113288076/df984e8f-5b06-49dd-ad01-3bdf8647079e)



در این مثال:

1. در مرحله "Build"، فایل‌های موجود در دایرکتوری `src/` با دستور `stash` آرشیو شده و با نام `myStash` در Jenkins ذخیره می‌شوند.

2. در مرحله "Test"، فایل‌های آرشیو شده با دستور `unstash` بازیابی می‌شوند و می‌توانید عملیات‌های مورد نظر (مثلاً انجام تست‌ها) را انجام دهید.


به یاد داشته باشید که نام stash باید در مراحل مختلف یکسان باشد تا بتوانید فایل‌ها را بازیابی کنید.

حالا اگر یک بار پایپ لاین را بیلد کنیم متوجه میشویم که در آخر فایل حذف میشود . حالا اگر بخواهیم دوباره بیلد کنیم اما این بار از استیج دوم فایلی ساخته نشده است که بخواهد آن را CAT کند . در این مورقع است که stash استفاده شده میتواند مرحله قبلی را داخل خود SAVE نگه دارد .

---


stash:


برای آرشیو کردن (پنهان کردن) یک یا چند فایل در یک مرحله از Pipeline استفاده می‌شود.
این دستور یک یا چند فایل را در یک stash نامگذاری شده (با یک نام خاص) آرشیو می‌کند.
فایل‌های آرشیو شده در مرحله مربوطه به یک یا چند stash با یک نام خاص ذخیره می‌شوند.




unstash 
    
برای بازیابی (به دست آوردن) فایل‌های آرشیو شده در یک stash از یک مرحله به مرحله دیگر استفاده می‌شود.
این دستور فایل‌های آرشیو شده از stash مربوطه را باز می‌کند تا بتوانید از آن‌ها در مرحله جاری یا مراحل بعدی استفاده کنید.
